---
- name: Template configuration.py
  ansible.builtin.template:
    src: configuration.py.j2
    dest: "{{ operations_management_netbox_install_dir }}/netbox/netbox/configuration.py"
    owner: "{{ operations_management_netbox_user }}"
    group: "{{ operations_management_netbox_user }}"
    mode: "0640"
  notify: Restart NetBox

- name: Template systemd service
  ansible.builtin.template:
    src: netbox.service.j2
    dest: "{{ operations_management_netbox_systemd_unit }}"
    mode: "0644"
  notify: Restart NetBox

- name: Ensure log directory exists
  ansible.builtin.file:
    path: /var/log/netbox
    state: directory
    owner: "{{ operations_management_netbox_user }}"
    group: "{{ operations_management_netbox_user }}"
    mode: "0755"
