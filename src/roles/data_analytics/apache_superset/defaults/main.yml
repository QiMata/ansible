---
apache_superset__system_packages_default:
  - build-essential
  - libssl-dev
  - libffi-dev
  - python3-dev
  - python3-pip
  - libsasl2-dev
  - libldap2-dev
  - default-libmysqlclient-dev
  - libpq-dev

apache_superset__additional_python_packages_default: []
apache_superset__feature_flags_default: {}
apache_superset__celery_beat_schedule_default: {}
apache_superset__custom_plugins_default: []
apache_superset__cache_config_default:
  CACHE_TYPE: "SimpleCache"
  CACHE_DEFAULT_TIMEOUT: 300
apache_superset__results_cache_config_default:
  CACHE_TYPE: "SimpleCache"
  CACHE_DEFAULT_TIMEOUT: 3600
apache_superset__thumbnail_cache_config_default:
  CACHE_TYPE: "SimpleCache"
  CACHE_DEFAULT_TIMEOUT: 86400
apache_superset__firewall_allowed_ips_default: []
apache_superset__oauth_providers_default: []
apache_superset__superset_config_backup_schedule_default: "0 3 * * *"
apache_superset__db_backup_schedule_default: "0 2 * * *"

apache_superset_version: "{{ superset_version | default('latest') }}"
apache_superset_user: "{{ superset_user | default('superset') }}"
apache_superset_group: "{{ superset_group | default('superset') }}"
apache_superset_install_dir: "{{ superset_install_dir | default('/opt/superset') }}"
apache_superset_venv_dir: >-
  {{ superset_venv_dir | default(apache_superset_install_dir + '/venv') }}
apache_superset_config_dir: "{{ superset_config_dir | default('/etc/superset') }}"
apache_superset_config_path: >-
  {{ superset_config_path | default(apache_superset_config_dir + '/superset_config.py') }}

apache_superset_system_packages: >-
  {{ superset_system_packages | default(apache_superset__system_packages_default) }}
apache_superset_additional_python_packages: >-
  {{ superset_additional_python_packages | default(apache_superset__additional_python_packages_default) }}
apache_superset_database_uri: >-
  {{ superset_database_uri | default('sqlite:////' + apache_superset_install_dir + '/superset.db') }}

apache_superset_secret_key: "{{ superset_secret_key | default('CHANGEME') }}"
apache_superset_admin_username: "{{ superset_admin_username | default('admin') }}"
apache_superset_admin_password: "{{ superset_admin_password | default('CHANGEME') }}"
apache_superset_admin_email: "{{ superset_admin_email | default('admin@example.com') }}"
apache_superset_admin_firstname: "{{ superset_admin_firstname | default('Superset') }}"
apache_superset_admin_lastname: "{{ superset_admin_lastname | default('Admin') }}"

apache_superset_load_examples: "{{ superset_load_examples | default(false) | bool }}"
apache_superset_use_gunicorn: "{{ superset_use_gunicorn | default(true) | bool }}"
apache_superset_gunicorn_workers: "{{ superset_gunicorn_workers | default(4) | int }}"
apache_superset_gunicorn_bind: "{{ superset_gunicorn_bind | default('0.0.0.0:8088') }}"

apache_superset_redis_url: "{{ superset_redis_url | default('') }}"
apache_superset_celery_broker_url: "{{ superset_celery_broker_url | default('') }}"

apache_superset_feature_flags: >-
  {{ superset_feature_flags | default(apache_superset__feature_flags_default) }}

apache_superset_service_name: "{{ superset_service_name | default('superset') }}"
apache_superset_marker_file: >-
  {{ superset_marker_file | default(apache_superset_config_dir + '/.admin_created') }}

apache_superset_ssl_enabled: "{{ superset_ssl_enabled | default(false) | bool }}"
apache_superset_ssl_cert_path: "{{ superset_ssl_cert_path | default('/etc/ssl/certs/superset.crt') }}"
apache_superset_ssl_key_path: "{{ superset_ssl_key_path | default('/etc/ssl/private/superset.key') }}"
apache_superset_ssl_ca_path: "{{ superset_ssl_ca_path | default('') }}"
apache_superset_ssl_protocols: "{{ superset_ssl_protocols | default('TLSv1.2 TLSv1.3') }}"
apache_superset_ssl_ciphers: >-
  {{ superset_ssl_ciphers | default('ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS') }}
apache_superset_ssl_dhparam_path: "{{ superset_ssl_dhparam_path | default('/etc/ssl/certs/dhparam.pem') }}"

apache_superset_celery_enabled: "{{ superset_celery_enabled | default(false) | bool }}"
apache_superset_celery_workers: "{{ superset_celery_workers | default(2) | int }}"
apache_superset_celery_beat_enabled: "{{ superset_celery_beat_enabled | default(false) | bool }}"
apache_superset_celery_beat_schedule: >-
  {{ superset_celery_beat_schedule | default(apache_superset__celery_beat_schedule_default) }}
apache_superset_celery_worker_log_level: "{{ superset_celery_worker_log_level | default('info') }}"
apache_superset_celery_worker_concurrency: "{{ superset_celery_worker_concurrency | default(4) | int }}"
apache_superset_celery_result_backend: >-
  {{ superset_celery_result_backend | default(apache_superset_celery_broker_url) }}

apache_superset_db_auto_create: "{{ superset_db_auto_create | default(false) | bool }}"
apache_superset_db_validate_connection: "{{ superset_db_validate_connection | default(true) | bool }}"
apache_superset_db_backup_enabled: "{{ superset_db_backup_enabled | default(false) | bool }}"
apache_superset_db_backup_schedule: >-
  {{ superset_db_backup_schedule | default(apache_superset__db_backup_schedule_default) }}
apache_superset_db_backup_retention_days: "{{ superset_db_backup_retention_days | default(7) | int }}"
apache_superset_db_backup_path: "{{ superset_db_backup_path | default('/var/backups/superset') }}"

apache_superset_auth_type: "{{ superset_auth_type | default('AUTH_DB') }}"
apache_superset_ldap_enabled: "{{ superset_ldap_enabled | default(false) | bool }}"
apache_superset_ldap_server: "{{ superset_ldap_server | default('') }}"
apache_superset_ldap_use_tls: "{{ superset_ldap_use_tls | default(true) | bool }}"
apache_superset_ldap_bind_user: "{{ superset_ldap_bind_user | default('') }}"
apache_superset_ldap_bind_password: "{{ superset_ldap_bind_password | default('') }}"
apache_superset_ldap_basedn: "{{ superset_ldap_basedn | default('') }}"
apache_superset_ldap_search: "{{ superset_ldap_search | default('') }}"
apache_superset_ldap_uid_field: "{{ superset_ldap_uid_field | default('uid') }}"
apache_superset_ldap_firstname_field: "{{ superset_ldap_firstname_field | default('givenName') }}"
apache_superset_ldap_lastname_field: "{{ superset_ldap_lastname_field | default('sn') }}"
apache_superset_ldap_email_field: "{{ superset_ldap_email_field | default('mail') }}"

apache_superset_oauth_enabled: "{{ superset_oauth_enabled | default(false) | bool }}"
apache_superset_oauth_providers: >-
  {{ superset_oauth_providers | default(apache_superset__oauth_providers_default) }}

apache_superset_log_level: "{{ superset_log_level | default('INFO') }}"
apache_superset_log_file: "{{ superset_log_file | default('/var/log/superset/superset.log') }}"
apache_superset_log_max_bytes: "{{ superset_log_max_bytes | default(104857600) | int }}"
apache_superset_log_backup_count: "{{ superset_log_backup_count | default(5) | int }}"
apache_superset_enable_access_log: "{{ superset_enable_access_log | default(true) | bool }}"
apache_superset_access_log_file: "{{ superset_access_log_file | default('/var/log/superset/access.log') }}"

apache_superset_metrics_enabled: "{{ superset_metrics_enabled | default(false) | bool }}"
apache_superset_metrics_port: "{{ superset_metrics_port | default(9090) | int }}"
apache_superset_health_check_enabled: "{{ superset_health_check_enabled | default(true) | bool }}"
apache_superset_health_check_path: "{{ superset_health_check_path | default('/health') }}"

apache_superset_email_enabled: "{{ superset_email_enabled | default(false) | bool }}"
apache_superset_smtp_host: "{{ superset_smtp_host | default('') }}"
apache_superset_smtp_port: "{{ superset_smtp_port | default(587) | int }}"
apache_superset_smtp_use_tls: "{{ superset_smtp_use_tls | default(true) | bool }}"
apache_superset_smtp_username: "{{ superset_smtp_username | default('') }}"
apache_superset_smtp_password: "{{ superset_smtp_password | default('') }}"
apache_superset_smtp_mail_from: "{{ superset_smtp_mail_from | default('superset@example.com') }}"

apache_superset_custom_plugins: >-
  {{ superset_custom_plugins | default(apache_superset__custom_plugins_default) }}

apache_superset_rls_enabled: "{{ superset_rls_enabled | default(false) | bool }}"

apache_superset_cache_config: >-
  {{ superset_cache_config | default(apache_superset__cache_config_default) }}
apache_superset_results_cache_config: >-
  {{ superset_results_cache_config | default(apache_superset__results_cache_config_default) }}
apache_superset_thumbnail_cache_config: >-
  {{ superset_thumbnail_cache_config | default(apache_superset__thumbnail_cache_config_default) }}

apache_superset_gunicorn_timeout: "{{ superset_gunicorn_timeout | default(300) | int }}"
apache_superset_gunicorn_keepalive: "{{ superset_gunicorn_keepalive | default(2) | int }}"
apache_superset_gunicorn_max_requests: "{{ superset_gunicorn_max_requests | default(1000) | int }}"
apache_superset_gunicorn_max_requests_jitter: "{{ superset_gunicorn_max_requests_jitter | default(100) | int }}"
apache_superset_gunicorn_preload_app: "{{ superset_gunicorn_preload_app | default(true) | bool }}"
apache_superset_gunicorn_worker_class: "{{ superset_gunicorn_worker_class | default('sync') }}"
apache_superset_gunicorn_worker_connections: "{{ superset_gunicorn_worker_connections | default(1000) | int }}"

apache_superset_firewall_enabled: "{{ superset_firewall_enabled | default(false) | bool }}"
apache_superset_firewall_allowed_ips: >-
  {{ superset_firewall_allowed_ips | default(apache_superset__firewall_allowed_ips_default) }}
apache_superset_fail2ban_enabled: "{{ superset_fail2ban_enabled | default(false) | bool }}"
apache_superset_csp_enabled: "{{ superset_csp_enabled | default(false) | bool }}"
apache_superset_csp_policy: >-
  {{ superset_csp_policy | default("default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';") }}
apache_superset_rate_limiting_enabled: "{{ superset_rate_limiting_enabled | default(false) | bool }}"
apache_superset_rate_limit_per_minute: "{{ superset_rate_limit_per_minute | default(100) | int }}"

apache_superset_config_backup_enabled: "{{ superset_config_backup_enabled | default(false) | bool }}"
apache_superset_config_backup_schedule: >-
  {{ superset_config_backup_schedule | default(apache_superset__superset_config_backup_schedule_default) }}
apache_superset_config_backup_path: "{{ superset_config_backup_path | default('/var/backups/superset-config') }}"
apache_superset_config_backup_retention_days: "{{ superset_config_backup_retention_days | default(30) | int }}"
