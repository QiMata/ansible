---
# OpenLDAP Monitoring Configuration
openldap_monitoring_enabled: true

# Prometheus Integration
openldap_monitoring_prometheus: true
openldap_prometheus_port: 9330
openldap_prometheus_endpoint: "/metrics"
openldap_prometheus_job_name: "openldap"
openldap_prometheus_scrape_interval: "30s"
openldap_prometheus_evaluation_interval: "30s"

# Grafana Integration
openldap_monitoring_grafana: true
openldap_grafana_dashboard_enabled: true
openldap_grafana_datasource_name: "prometheus"
openldap_grafana_dashboard_folder: "LDAP"

# Health Check Configuration
openldap_health_checks_enabled: true
openldap_health_check_interval: 60    # seconds
openldap_health_check_timeout: 10     # seconds
openldap_health_check_retries: 3
openldap_health_check_script: "/usr/local/bin/ldap-health-check"

# Performance Metrics
openldap_metrics_enabled: true
openldap_metrics_collection_interval: 30  # seconds
openldap_metrics_retention_days: 30

# Collected Metrics
openldap_collect_connection_metrics: true
openldap_collect_operation_metrics: true
openldap_collect_replication_metrics: true
openldap_collect_cache_metrics: true
openldap_collect_database_metrics: true
openldap_collect_schema_metrics: true

# Query Performance Monitoring
openldap_slow_query_monitoring: true
openldap_slow_query_threshold: 5000   # milliseconds
openldap_slow_query_log: "/var/log/openldap/slow-queries.log"

# Capacity Planning
openldap_capacity_monitoring: true
openldap_capacity_check_interval: 300 # seconds
openldap_capacity_disk_threshold: 80  # percentage
openldap_capacity_memory_threshold: 85 # percentage
openldap_capacity_connection_threshold: 80 # percentage of max connections

# Alerting Configuration
openldap_alerting_enabled: true
openldap_alert_email: "admin@{{ openldap_server_domain }}"
openldap_alert_slack_webhook: ""
openldap_alert_pagerduty_key: ""

# Alert Thresholds
openldap_alert_high_cpu: 80           # percentage
openldap_alert_high_memory: 85        # percentage
openldap_alert_disk_usage: 90         # percentage
openldap_alert_high_connections: 80   # percentage
openldap_alert_replication_lag: 300   # seconds
openldap_alert_failed_operations: 50  # per minute
openldap_alert_response_time: 5000    # milliseconds

# Log Monitoring
openldap_log_monitoring: true
openldap_log_analysis_enabled: true
openldap_log_error_patterns:
  - "connection_read"
  - "ber_get_next"
  - "connection_closing"
  - "send_ldap_result"

# Performance Baselines
openldap_performance_baseline_enabled: true
openldap_baseline_collection_period: 7  # days
openldap_baseline_update_frequency: 24  # hours

# Custom Monitoring Scripts
openldap_custom_monitoring_scripts: []
#  - name: "connection_monitor"
#    script: "/usr/local/bin/ldap-connection-monitor.sh"
#    interval: 60
#    enabled: true
#  - name: "replication_monitor"
#    script: "/usr/local/bin/ldap-replication-monitor.py"
#    interval: 120
#    enabled: true

# SNMP Monitoring (optional)
openldap_snmp_monitoring: false
openldap_snmp_community: "public"
openldap_snmp_port: 161

# External Monitoring Integration
openldap_external_monitoring: []
#  - type: "nagios"
#    server: "monitoring.example.com"
#    config_file: "/etc/nagios/conf.d/ldap.cfg"
#  - type: "zabbix"
#    server: "zabbix.example.com"
#    agent_config: "/etc/zabbix/zabbix_agentd.d/ldap.conf"
