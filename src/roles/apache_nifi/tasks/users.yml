---
- name: Ensure initial admin is set
  ansible.builtin.lineinfile:
    path: "{{ nifi_home }}/conf/authorizers.xml"
    regexp: '<property name="Initial Admin Identity">.*</property>'
    line: '<property name="Initial Admin Identity">{{ nifi_initial_admin_identity }}</property>'
    owner: "{{ nifi_user }}"
    group: "{{ nifi_group }}"
    mode: "0640"
  when: nifi_security_mode == 'ssl' and nifi_initial_admin_identity != ''
  notify: restart nifi
