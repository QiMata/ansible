---
# pfSense Configuration Role - Main Tasks
# This role configures all major components of pfSense

- name: Include system settings configuration
  ansible.builtin.include_tasks: system_settings.yml
  when: pfsense_configure_system_settings
  tags:
    - system
    - system_settings

- name: Include certificate management
  ansible.builtin.include_tasks: certificates.yml
  when: pfsense_configure_certificates
  tags:
    - certificates
    - ssl

- name: Include interface configuration
  ansible.builtin.include_tasks: interfaces.yml
  when: pfsense_configure_interfaces
  tags:
    - interfaces
    - lans
    - network

- name: Include VLAN configuration
  ansible.builtin.include_tasks: vlans.yml
  when: pfsense_configure_vlans
  tags:
    - vlans
    - network

- name: Include gateway configuration
  ansible.builtin.include_tasks: gateways.yml
  when: pfsense_configure_gateways
  tags:
    - gateways
    - routing

- name: Include static routes configuration
  ansible.builtin.include_tasks: static_routes.yml
  when: pfsense_configure_static_routes
  tags:
    - routes
    - routing

- name: Include DHCP server configuration
  ansible.builtin.include_tasks: dhcp.yml
  when: pfsense_configure_dhcp
  tags:
    - dhcp
    - network

- name: Include DNS configuration
  ansible.builtin.include_tasks: dns.yml
  when: pfsense_configure_dns
  tags:
    - dns
    - resolver

- name: Include aliases configuration
  ansible.builtin.include_tasks: aliases.yml
  when: pfsense_configure_aliases
  tags:
    - aliases
    - firewall

- name: Include NAT rules configuration
  ansible.builtin.include_tasks: nat_rules.yml
  when: pfsense_configure_nat
  tags:
    - nat
    - firewall

- name: Include firewall rules configuration
  ansible.builtin.include_tasks: firewall_rules.yml
  when: pfsense_configure_firewall_rules
  tags:
    - firewall
    - rules

- name: Include traffic shaping configuration
  ansible.builtin.include_tasks: traffic_shaping.yml
  when: pfsense_configure_traffic_shaping
  tags:
    - qos
    - traffic_shaping

- name: Include user authentication configuration
  ansible.builtin.include_tasks: user_auth.yml
  when: pfsense_configure_user_auth
  tags:
    - auth
    - users

- name: Include captive portal configuration
  ansible.builtin.include_tasks: captive_portal.yml
  when: pfsense_configure_captive_portal
  tags:
    - captive_portal
    - guest

- name: Include OpenVPN configuration
  ansible.builtin.include_tasks: openvpn.yml
  when: pfsense_configure_openvpn
  tags:
    - openvpn
    - vpn

- name: Include IPsec site-to-site VPN configuration
  ansible.builtin.include_tasks: ipsec_s2s.yml
  when: pfsense_configure_ipsec
  tags:
    - ipsec
    - vpn
    - s2s

- name: Include package management
  ansible.builtin.include_tasks: packages.yml
  when: pfsense_configure_packages
  tags:
    - packages

- name: Include backup configuration
  ansible.builtin.include_tasks: backup.yml
  when: pfsense_perform_backup
  tags:
    - backup

- name: Include system updates
  ansible.builtin.include_tasks: updates.yml
  when: pfsense_perform_updates
  tags:
    - updates
    - maintenance
