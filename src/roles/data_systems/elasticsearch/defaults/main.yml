---
# ============================================================================
# BASIC CONFIGURATION
# ============================================================================

# Elasticsearch package and repository version
es_version: "8.x"

# Cluster configuration
es_cluster_name: "elasticsearch-cluster"
es_node_roles: []
es_network_host: "{{ ansible_default_ipv4.address }}"

# JVM heap size
es_heap_size: "2g"

# Install OpenJDK if required
es_install_java: true

# Environment configuration
es_environment: "production"  # dev, staging, production

# ============================================================================
# STORAGE AND PATHS CONFIGURATION
# ============================================================================

# Data paths configuration
es_data_paths:
  - "/var/lib/elasticsearch"
es_log_path: "/var/log/elasticsearch"
es_config_path: "/etc/elasticsearch"
es_home_path: "/usr/share/elasticsearch"
es_pid_path: "/var/run/elasticsearch"

# Snapshot repository paths
es_path_repo: []

# Custom storage settings
es_store_type: "fs"  # fs, niofs, mmapfs, hybridfs
es_allow_mmapfs: true

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# Basic security settings
es_enable_security: false
es_tls_provided: false

# Advanced security features
es_api_key_enabled: false
es_audit_enabled: false
es_field_level_security: false
es_document_level_security: false

# Audit settings
es_audit_settings:
  enabled: false
  outputs: ["logfile"]
  logfile:
    events:
      include: ["access_denied", "access_granted", "anonymous_access_denied"]
      exclude: []

# LDAP settings for security integration
ldap_url: ""
ldap_bind_dn: ""
ldap_bind_password: ""
ldap_user_base_dn: ""
ldap_group_base_dn: ""
ldap_admin_group_dn: ""
ldap_user_group_dn: ""

# ============================================================================
# PLUGIN MANAGEMENT
# ============================================================================

# Elasticsearch plugins to install
es_plugins: []
# Example:
# es_plugins:
#   - name: "repository-s3"
#     version: "{{ es_version }}"
#   - name: "analysis-icu"

# Plugin removal list
es_plugins_remove: []

# ============================================================================
# INDEX TEMPLATE MANAGEMENT
# ============================================================================

# Index templates configuration
es_index_templates: []
# Example:
# es_index_templates:
#   - name: "logs-template"
#     index_patterns: ["logs-*"]
#     settings:
#       number_of_shards: 1
#       number_of_replicas: 1
#     mappings:
#       properties:
#         timestamp:
#           type: date

# Component templates
es_component_templates: []

# Index lifecycle policies
es_index_lifecycle_policies: []
# Example:
# es_index_lifecycle_policies:
#   - name: "logs-policy"
#     phases:
#       hot:
#         actions:
#           rollover:
#             max_size: "10gb"
#             max_age: "7d"
#       delete:
#         min_age: "30d"

# ============================================================================
# SNAPSHOT AND BACKUP CONFIGURATION
# ============================================================================

# Snapshot repositories
es_snapshot_repositories: []
# Example:
# es_snapshot_repositories:
#   - name: "backup-repo"
#     type: "fs"
#     settings:
#       location: "/backup/elasticsearch"

# Snapshot policies
es_snapshot_policies: []
# Example:
# es_snapshot_policies:
#   - name: "daily-backup"
#     schedule: "0 1 * * *"
#     repository: "backup-repo"
#     config:
#       retention:
#         expire_after: "30d"

# Backup retention
es_backup_retention_days: 30

# ============================================================================
# MONITORING AND ALERTING
# ============================================================================

# Monitoring configuration
es_enable_monitoring: false
es_monitoring_cluster_uuid: ""
es_monitoring_collection_enabled: true
es_monitoring_exporters: {}

# Watcher configuration
es_watcher_enabled: false
es_watcher_encrypt_sensitive_data: false

# Alerting settings
es_alerting_enabled: false

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Thread pool settings
es_thread_pool_settings:
  search:
    size: "{{ ansible_processor_cores }}"
    queue_size: 1000
  write:
    size: "{{ ansible_processor_cores }}"
    queue_size: 10000

# Circuit breaker settings
es_circuit_breaker_settings:
  total:
    limit: "95%"
  fielddata:
    limit: "40%"
  request:
    limit: "60%"

# Cache settings
es_cache_settings:
  indices:
    queries:
      size: "10%"
    fielddata:
      size: "20%"
    requests:
      size: "1%"

# JVM additional options
es_jvm_options: []
# Example:
# es_jvm_options:
#   - "-XX:+UseG1GC"
#   - "-XX:MaxGCPauseMillis=200"

# Bootstrap memory lock
es_bootstrap_memory_lock: true

# ============================================================================
# LOAD BALANCER/PROXY CONFIGURATION
# ============================================================================

# Proxy settings
es_behind_proxy: false
es_proxy_settings:
  http_host: "0.0.0.0"
  http_port: 9200
  transport_host: "{{ ansible_default_ipv4.address }}"
  transport_port: 9300
  publish_host: "{{ ansible_default_ipv4.address }}"

# HTTP settings
es_http_compression: true
es_http_cors_enabled: false
es_http_cors_allow_origin: "*"
es_http_max_content_length: "100mb"

# ============================================================================
# CUSTOM CONFIGURATION
# ============================================================================

# Custom analyzers and filters
es_custom_analyzers: {}
es_custom_filters: {}
es_custom_tokenizers: {}

# Custom dictionaries
es_custom_dictionaries: []

# Log4j2 configuration
es_log4j2_custom: false
es_log_level: "INFO"
es_slow_log_threshold_query_warn: "10s"
es_slow_log_threshold_query_info: "5s"
es_slow_log_threshold_fetch_warn: "1s"
es_slow_log_threshold_fetch_info: "800ms"

# ============================================================================
# HEALTH CHECKS AND VALIDATION
# ============================================================================

# Health check settings
es_health_check_enabled: true
es_health_check_retries: 30
es_health_check_delay: 10
es_cluster_health_timeout: "30s"

# Validation settings
es_validate_config: true
es_validate_cluster_health: true
es_wait_for_cluster: true

# ============================================================================
# UPGRADE MANAGEMENT
# ============================================================================

# Upgrade settings
es_rolling_upgrade: false
es_upgrade_validation: true
es_backup_before_upgrade: true
es_upgrade_timeout: 600

# Version compatibility checks
es_check_version_compatibility: true

# ============================================================================
# MULTI-ENVIRONMENT SPECIFIC SETTINGS
# ============================================================================

# Environment-specific overrides
es_env_specific_settings: {}

# Development environment defaults
es_dev_settings:
  discovery.type: "single-node"
  cluster.routing.allocation.disk.threshold_enabled: false
  action.auto_create_index: true

# Production environment defaults
es_prod_settings:
  discovery.zen.minimum_master_nodes: "{{ ((groups['es_master'] | default([])) | length / 2) | round(0, 'ceil') | int }}"
  cluster.routing.allocation.disk.watermark.low: "85%"
  cluster.routing.allocation.disk.watermark.high: "90%"
  cluster.routing.allocation.disk.watermark.flood_stage: "95%"

# Staging environment defaults
es_staging_settings:
  discovery.type: "single-node"
  cluster.routing.allocation.disk.threshold_enabled: true
