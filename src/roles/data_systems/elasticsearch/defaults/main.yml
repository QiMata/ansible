---
# ============================================================================
# BASIC CONFIGURATION
# ============================================================================

# Elasticsearch package and repository version
elasticsearch_version: "8.x"

# Cluster configuration
elasticsearch_cluster_name: "elasticsearch-cluster"
elasticsearch_node_roles: ["master", "data", "ingest"]
elasticsearch_network_host: "{{ ansible_default_ipv4.address }}"

# JVM heap size
elasticsearch_heap_size: "2g"

# Install OpenJDK if required
elasticsearch_install_java: true

# Environment configuration
elasticsearch_environment: "production"  # dev, staging, production

# ============================================================================
# STORAGE AND PATHS CONFIGURATION
# ============================================================================

# Data paths configuration
elasticsearch_data_paths:
  - "/var/lib/elasticsearch"
elasticsearch_log_path: "/var/log/elasticsearch"
elasticsearch_config_path: "/etc/elasticsearch"
elasticsearch_home_path: "/usr/share/elasticsearch"
elasticsearch_pid_path: "/var/run/elasticsearch"

# Snapshot repository paths
elasticsearch_path_repo: []

# Custom storage settings
elasticsearch_store_type: "fs"  # fs, niofs, mmapfs, hybridfs
elasticsearch_allow_mmapfs: true

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# Basic security settings
elasticsearch_enable_security: false
elasticsearch_tls_provided: false

# Advanced security features
elasticsearch_api_key_enabled: false
elasticsearch_audit_enabled: false
elasticsearch_field_level_security: false
elasticsearch_document_level_security: false

# Audit settings
elasticsearch_audit_settings:
  enabled: false
  outputs: ["logfile"]
  logfile:
    events:
      include: ["access_denied", "access_granted", "anonymous_access_denied"]
      exclude: []

# LDAP settings for security integration
elasticsearch_ldap_url: ""
elasticsearch_ldap_bind_dn: ""
elasticsearch_ldap_bind_password: ""
elasticsearch_ldap_user_base_dn: ""
elasticsearch_ldap_group_base_dn: ""
elasticsearch_ldap_admin_group_dn: ""
elasticsearch_ldap_user_group_dn: ""

# ============================================================================
# PLUGIN MANAGEMENT
# ============================================================================

# Elasticsearch plugins to install
elasticsearch_plugins: []
# Example:
# elasticsearch_plugins:
#   - name: "repository-s3"
#     version: "{{ elasticsearch_version }}"
#   - name: "analysis-icu"

# Plugin removal list
elasticsearch_plugins_remove: []

# ============================================================================
# INDEX TEMPLATE MANAGEMENT
# ============================================================================

# Index templates configuration
elasticsearch_index_templates: []
# Example:
# elasticsearch_index_templates:
#   - name: "logs-template"
#     index_patterns: ["logs-*"]
#     settings:
#       number_of_shards: 1
#       number_of_replicas: 1
#     mappings:
#       properties:
#         timestamp:
#           type: date

# Component templates
elasticsearch_component_templates: []

# Index lifecycle policies
elasticsearch_index_lifecycle_policies: []
# Example:
# elasticsearch_index_lifecycle_policies:
#   - name: "logs-policy"
#     phases:
#       hot:
#         actions:
#           rollover:
#             max_size: "10gb"
#             max_age: "7d"
#       delete:
#         min_age: "30d"

# ============================================================================
# SNAPSHOT AND BACKUP CONFIGURATION
# ============================================================================

# Snapshot repositories
elasticsearch_snapshot_repositories: []
# Example:
# elasticsearch_snapshot_repositories:
#   - name: "backup-repo"
#     type: "fs"
#     settings:
#       location: "/backup/elasticsearch"

# Snapshot policies
elasticsearch_snapshot_policies: []
# Example:
# elasticsearch_snapshot_policies:
#   - name: "daily-backup"
#     schedule: "0 1 * * *"
#     repository: "backup-repo"
#     config:
#       retention:
#         expire_after: "30d"

# Backup retention
elasticsearch_backup_retention_days: 30

# ============================================================================
# MONITORING AND ALERTING
# ============================================================================

# Monitoring configuration
elasticsearch_enable_monitoring: false
elasticsearch_monitoring_cluster_uuid: ""
elasticsearch_monitoring_collection_enabled: true
elasticsearch_monitoring_exporters: {}

# Watcher configuration
elasticsearch_watcher_enabled: false
elasticsearch_watcher_encrypt_sensitive_data: false

# Alerting settings
elasticsearch_alerting_enabled: false

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Thread pool settings
elasticsearch_thread_pool_settings:
  search:
    size: "{{ ansible_processor_cores }}"
    queue_size: 1000
  write:
    size: "{{ ansible_processor_cores }}"
    queue_size: 10000

# Circuit breaker settings
elasticsearch_circuit_breaker_settings:
  total:
    limit: "95%"
  fielddata:
    limit: "40%"
  request:
    limit: "60%"

# Cache settings
elasticsearch_cache_settings:
  indices:
    queries:
      size: "10%"
    fielddata:
      size: "20%"
    requests:
      size: "1%"

# JVM additional options
elasticsearch_jvm_options: []
# Example:
# elasticsearch_jvm_options:
#   - "-XX:+UseG1GC"
#   - "-XX:MaxGCPauseMillis=200"

# Bootstrap memory lock
elasticsearch_bootstrap_memory_lock: true

# ============================================================================
# LOAD BALANCER/PROXY CONFIGURATION
# ============================================================================

# Proxy settings
elasticsearch_behind_proxy: false
elasticsearch_proxy_settings:
  http_host: "0.0.0.0"
  http_port: 9200
  transport_host: "{{ ansible_default_ipv4.address }}"
  transport_port: 9300
  publish_host: "{{ ansible_default_ipv4.address }}"

# HTTP settings
elasticsearch_http_compression: true
elasticsearch_http_cors_enabled: false
elasticsearch_http_cors_allow_origin: "*"
elasticsearch_http_max_content_length: "100mb"

# ============================================================================
# CUSTOM CONFIGURATION
# ============================================================================

# Custom analyzers and filters
elasticsearch_custom_analyzers: {}
elasticsearch_custom_filters: {}
elasticsearch_custom_tokenizers: {}

# Custom dictionaries
elasticsearch_custom_dictionaries: []

# Log4j2 configuration
elasticsearch_log4j2_custom: false
elasticsearch_log_level: "INFO"
elasticsearch_slow_log_threshold_query_warn: "10s"
elasticsearch_slow_log_threshold_query_info: "5s"
elasticsearch_slow_log_threshold_fetch_warn: "1s"
elasticsearch_slow_log_threshold_fetch_info: "800ms"

# ============================================================================
# HEALTH CHECKS AND VALIDATION
# ============================================================================

# Health check settings
elasticsearch_health_check_enabled: true
elasticsearch_health_check_retries: 30
elasticsearch_health_check_delay: 10
elasticsearch_cluster_health_timeout: "30s"

# Validation settings
elasticsearch_validate_config: true
elasticsearch_validate_cluster_health: true
elasticsearch_wait_for_cluster: true

# ============================================================================
# UPGRADE MANAGEMENT
# ============================================================================

# Upgrade settings
elasticsearch_rolling_upgrade: false
elasticsearch_upgrade_validation: true
elasticsearch_backup_before_upgrade: true
elasticsearch_upgrade_timeout: 600

# Version compatibility checks
elasticsearch_check_version_compatibility: true

# ============================================================================
# MULTI-ENVIRONMENT SPECIFIC SETTINGS
# ============================================================================

# Environment-specific overrides
elasticsearch_env_specific_settings: {}

# Development environment defaults
elasticsearch_dev_settings:
  discovery.type: "single-node"
  cluster.routing.allocation.disk.threshold_enabled: false
  action.auto_create_index: true
  xpack.security.enabled: false
  xpack.security.enrollment.enabled: false

# Production environment defaults
elasticsearch_prod_settings:
  discovery.zen.minimum_master_nodes: "{{ ((groups['es_master'] | default([])) | length / 2) | round(0, 'ceil') | int }}"
  cluster.routing.allocation.disk.watermark.low: "85%"
  cluster.routing.allocation.disk.watermark.high: "90%"
  cluster.routing.allocation.disk.watermark.flood_stage: "95%"

# Staging environment defaults
elasticsearch_staging_settings:
  discovery.type: "single-node"
  cluster.routing.allocation.disk.threshold_enabled: true
