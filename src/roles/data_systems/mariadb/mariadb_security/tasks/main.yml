---
- name: Include SSL/TLS configuration tasks
  ansible.builtin.include_tasks: ssl_tls.yml
  when: mariadb_ssl_enabled | bool

- name: Include password validation tasks
  ansible.builtin.include_tasks: password_validation.yml
  when: mariadb_password_validation_enabled | bool

- name: Include security hardening tasks
  ansible.builtin.include_tasks: security_hardening.yml
  when: mariadb_security_hardening_enabled | bool

- name: Include user management tasks
  ansible.builtin.include_tasks: user_management.yml
  when: mariadb_users | length > 0 or mariadb_roles | length > 0

- name: Include audit logging tasks
  ansible.builtin.include_tasks: audit_logging.yml
  when: mariadb_audit_enabled | bool

- name: Include firewall configuration tasks
  ansible.builtin.include_tasks: firewall.yml
  when: mariadb_firewall_enabled | bool

- name: Include encryption at rest tasks
  ansible.builtin.include_tasks: encryption_at_rest.yml
  when: mariadb_encryption_at_rest_enabled | bool

- name: Restart MariaDB service
  ansible.builtin.service:
    name: mariadb
    state: restarted
  notify: restart mariadb
